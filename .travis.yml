language: go

go:
  - 1.12.x


os:
  - linux

go_import_path: github.com/appsody/controller

services:
- docker

# skip because dependencies are baked in vendor dir
install: true

script:
  - make lint
  - make test

# note before_deploy will run before each deploy provider
before_deploy:
  - make VERSION=${TRAVIS_TAG} package

deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: "OJgQOTMTVl/4xm2LZIldWGeuusgmACN9d0w9ZVBB6kF67A8TV4ImOFERdwn99laEvz+I+7F0imrGZ03ayZo/gXB+8+jeM1yPWeVZqFkQgIMqpS3u0qJRc4xyt23ajpfGX/0mfkxo72CnD6AnSdMZcl9DTNjJ9vwFRaNw7nTv02wDeQsaVEr834MnvAnQZX3ZK6pBVbktyDh+pntFUod/g7874ATW+rNZKq1THGc36ZG7An4p6P/AFmlUFObPGjaGzPB8TmoSvRHz9IV7yhZMaaRhneH/kNyCB1JxphfQENRWc/9mktWmkl9Qfud0KA/yfGPneJ6rzzv4SfwqsVKz0Juszz5K2FvSKOdxTicTZ6jWzNSFsZQQdm2LhesyfkVOEReErrhnbpXpduVR/tUtfrx+RdtjspqmiRTBNMSnAsZuvzRj7XWtyxHB9pXMAH2Nz3fA8LPtwxOfLg2fTe8NxFIbd3Gt0jEnIrC4pONrWQrDgtdkV2CycqyNXORqhyaQeyXJ/vVARfIs2GGTfGCx640oP838Sm+QZy2T/qLcdsz185hghjZNyD+z2ZeWL+wpihm4tTlaUu8KQ1O/s9AF08fEXoBEJ5LAB49n4HxTR4aIIE/YnKjAKcwgKtLhwukS6sKJlPFH8Hrn9Wj6dQj5exnqAdBc/WD0jhIr/IL4S+Y="
  file: package/*
  file_glob: true
  on:
    tags: true
    repo: appsody/controller